ğŸš€ Hono Load Test has been deployed!

ğŸ“‹ Deployment Summary:
   Release: {{ .Release.Name }}
   Namespace: {{ .Release.Namespace }}
   Chart: {{ .Chart.Name }}-{{ .Chart.Version }}

ğŸ¯ Test Configuration:
   â€¢ Profile: {{ .Values.profile }}
{{- if .Values.overrides.tenants }}
   â€¢ Tenants: {{ .Values.overrides.tenants }} (overridden)
{{- end }}
{{- if .Values.overrides.devices }}
   â€¢ Devices: {{ .Values.overrides.devices }} total (overridden)
{{- end }}
{{- if .Values.overrides.protocols }}
   â€¢ Protocols: {{ .Values.overrides.protocols }} (overridden)
{{- end }}
   â€¢ Caching: {{ if .Values.cache.enabled }}Enabled{{ else }}Disabled{{ end }}
   â€¢ Hono Registry: {{ .Values.hono.registryIp }}:{{ .Values.hono.registryPort }}

ğŸ“Š Services:
{{- if .Values.registrar.enabled }}
   âœ… Registrar: Creates tenants and devices (with caching)
{{- end }}
{{- if .Values.validator.enabled }}
   âœ… Validator: Validates device connectivity
{{- end }}
{{- if .Values.loadgen.enabled }}
   âœ… Load Generator: Runs load tests
{{- end }}

ğŸ” Monitor Progress:
   # Check job status
   kubectl get jobs -n {{ .Release.Namespace }} -l app.kubernetes.io/instance={{ .Release.Name }}
   
   # Watch all logs
   kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/instance={{ .Release.Name }} -f
   
   # Check specific service logs
   kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/component=registrar -f
   kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/component=validator -f
   kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/component=loadgen -f

{{- if .Values.persistence.enabled }}
ğŸ“ Storage:
   â€¢ Shared Data: {{ include "hono-load-test.pvcName" . }}
{{- if .Values.cachePersistence.enabled }}
   â€¢ Cache: {{ include "hono-load-test.fullname" . }}-cache
{{- end }}
{{- if .Values.reports.enabled }}
   â€¢ Reports: {{ include "hono-load-test.fullname" . }}-reports
{{- end }}
   
   # Access reports
   kubectl exec -n {{ .Release.Namespace }} -it \
     $(kubectl get pods -n {{ .Release.Namespace }} -l app.kubernetes.io/component=loadgen -o jsonpath='{.items[0].metadata.name}') \
     -- ls -la /app/reports
{{- end }}

â±ï¸  Execution Order:
   1. Registrar: Creates/reuses cached tenants and devices
   2. Validator: Validates device connectivity
   3. Load Generator: Runs profile-based load test

ğŸ’¡ Quick Commands:
   # View test results
   kubectl logs -n {{ .Release.Namespace }} job/{{ .Release.Name }}-loadgen

   # Copy reports to local
   kubectl cp -n {{ .Release.Namespace }} \
     $(kubectl get pods -n {{ .Release.Namespace }} -l app.kubernetes.io/component=loadgen -o jsonpath='{.items[0].metadata.name}'):/app/reports \
     ./reports

   # Cleanup
   helm uninstall {{ .Release.Name }}

ğŸ“– Available Profiles:
   - smoke: Quick test (1 tenant, 1 device, mqtt, 60s)
   - standard: Standard test (5 tenants, 100 devices, mqtt+http, 600s)
   - stress: Heavy test (10 tenants, 500 devices, mqtt+http, 1800s)

ğŸ¯ Run Different Profiles:
   helm upgrade {{ .Release.Name }} ./chart --set profile=standard
   helm upgrade {{ .Release.Name }} ./chart --set profile=stress

ğŸ¯ Test Scenarios Available:
   â€¢ Use "--set test.deviceCount=10 --set test.messageInterval=5.75" for "10fast" scenario
   â€¢ Use "--set test.deviceCount=100 --set test.messageInterval=60" for "100slow" scenario

ğŸ“ˆ Statistics:
   Load generation statistics will be logged in real-time by the loadgen pods.

For more information, visit: https://github.com/eclipse/hono
